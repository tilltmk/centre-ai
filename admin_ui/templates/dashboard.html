{% extends "base.html" %}

{% block title %}Dashboard - Centre AI{% endblock %}

{% block content %}
<div class="page-header">
    <h1 class="page-title">Dashboard</h1>
    <p class="page-subtitle">Overview of your knowledge management system</p>
</div>

<div class="stats-grid">
    <div class="stat-card">
        <div class="stat-value">{{ stats.memories }}</div>
        <div class="stat-label">Memories</div>
    </div>
    <div class="stat-card">
        <div class="stat-value">{{ stats.codebases }}</div>
        <div class="stat-label">Codebases</div>
    </div>
    <div class="stat-card">
        <div class="stat-value">{{ stats.projects }}</div>
        <div class="stat-label">Projects</div>
    </div>
    <div class="stat-card">
        <div class="stat-value">{{ stats.instructions }}</div>
        <div class="stat-label">Instructions</div>
    </div>
    <div class="stat-card">
        <div class="stat-value">{{ stats.conversations }}</div>
        <div class="stat-label">Conversations</div>
    </div>
</div>

<div class="grid-2">
    <div class="card">
        <div class="card-header">
            <h3 class="card-title">Vector Store Status</h3>
        </div>
        <table>
            <thead>
                <tr>
                    <th>Collection</th>
                    <th>Vectors</th>
                </tr>
            </thead>
            <tbody>
                {% for name, data in stats.vectors.items() %}
                <tr>
                    <td>{{ name }}</td>
                    <td>{{ data.vectors_count }}</td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>

    <div class="card">
        <div class="card-header">
            <h3 class="card-title">Quick Actions</h3>
        </div>
        <div style="display: flex; flex-direction: column; gap: 0.75rem;">
            <a href="/conversations" class="btn btn-primary" style="text-align: center;">ðŸ’¬ Browse Conversations</a>
            <a href="/memories" class="btn btn-secondary" style="text-align: center;">Add Memory</a>
            <div style="display: flex; gap: 0.5rem;">
                <button onclick="quickInstruction()" class="btn btn-warning" style="flex: 1; text-align: center;">âš¡ Quick Instruction</button>
                <button onclick="autoMemory()" class="btn btn-info" style="flex: 1; text-align: center;">ðŸ§  Auto Memory</button>
            </div>
            <a href="/codebases" class="btn btn-secondary" style="text-align: center;">Index Codebase</a>
            <a href="/instructions" class="btn btn-secondary" style="text-align: center;">Add Instruction</a>
            <a href="/knowledge" class="btn btn-secondary" style="text-align: center;">View Knowledge Graph</a>
            <a href="/configs" class="btn btn-primary" style="text-align: center;">ðŸ“± Client Configurations</a>
            <a href="/git-projects" class="btn btn-success" style="text-align: center;">ðŸ”— Git Projects</a>
        </div>

        <script>
        function quickInstruction() {
            const instruction = prompt("Quick instruction for Claude:");
            if (instruction) {
                fetch('/api/quick-instruction', {
                    method: 'POST',
                    headers: {'Content-Type': 'application/json'},
                    body: JSON.stringify({instruction: instruction, priority: 7})
                }).then(r => r.json()).then(data => {
                    alert(data.success ? 'Instruction stored!' : 'Error: ' + data.error);
                });
            }
        }

        function autoMemory() {
            const content = prompt("Content for auto memory creation:");
            if (content) {
                fetch('/api/auto-memory', {
                    method: 'POST',
                    headers: {'Content-Type': 'application/json'},
                    body: JSON.stringify({content: content})
                }).then(r => r.json()).then(data => {
                    alert(data.success ? 'Memory created: ' + data.memory_created : 'Error: ' + data.error);
                });
            }
        }
        </script>
    </div>
</div>

<div class="card mt-3">
    <div class="card-header">
        <h3 class="card-title">MCP Connection</h3>
    </div>
    <p class="text-sm text-muted mb-2">Connect AI clients to your Centre AI MCP Server using SSE transport.</p>
    <div class="code-block">
{
  "mcpServers": {
    "centre-ai": {
      "url": "http://your-server:2068/sse",
      "transport": "sse",
      "headers": {
        "Authorization": "Bearer YOUR_MCP_TOKEN"
      }
    }
  }
}
    </div>
    <p class="text-xs text-muted mt-2">Find your token in <a href="/settings" style="text-decoration: underline;">Settings</a></p>
</div>
{% endblock %}
